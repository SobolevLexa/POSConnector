var POSConnector=function(){"use strict";function n(n,e){var t={};return t.type=n,t.listenerCallback=e,t}function e(n,t,a){if("function"==typeof t)return void 0===i?i=0:i+=1,c[i]=t,new e(n,i,a);var o={};return o.name=n,o.callbackId=t,o.body=a,o}function t(n){window.webkit.messageHandlers.POS.postMessage(n)}function a(){s.forEach(function(n){n.type===r.EventType.ConnectionEstablished&&n.listenerCallback()})}function o(n){var e=n.body;s.forEach(function(n){n.type===r.EventType.BarcodeScanned&&n.listenerCallback(e)})}var i,r={},c={},s=[],l={ConnectionEstablished:"ConnectionEstablished",GetLoginInformation:"GetLoginInformation",GetLoginInformationCallback:"GetLoginInformationCallback",PayBasket:"PayBasket",PayBasketCallback:"PayBasketCallback",BarcodeScanned:"BarcodeScanned"},d={NotConnected:"No connection is established from the native POS application"};return r.receiveMessage=function(n){switch(console.log("receiveMessage: "+n),n.name){case l.ConnectionEstablished:a();break;case l.BarcodeScanned:o(n);break;default:console.log("Unknown message name: "+n.name)}},r.LineItem=function(n,e,t,a,o,i,r,c){var s={};return s.name=n,s.quantity=e,s.unitPrice=t,s.vatPercentage=a,s.salesTaxPercentage=o,s.productId=i,s.imei=r,s.discounts=c,s},r.TransactionType={Cash:"Cash",Debitor:"Debitor",Ecommerce:"Ecommerce",External:"External",ExternalCard:"ExternalCard",ExternalGiftCard:"ExternalGiftCard",GiftCardVoucher:"GiftCardVoucher",Installment:"Installment",MobilePay:"MobilePay",Point:"Point"},r.Transaction=function(n,e){var t={};return t.type=n,t.amount=e,t},r.Discount=function(n,e,t){var a={};return a.amount=n,a.description=e,a.percentage=t,a},r.Basket=function(n,e,t,a){var o={};return o.id=n,o.lineItems=e,o.transactions=t,o.discounts=a,o},r.EventType={ConnectionEstablished:"ConnectionEstablished",BarcodeScanned:"BarcodeScanned"},r.on=function(e,t){var a=[e,t];console.log("on: "+a.join(", ")),s.push(new n(e,t))},r.removeEventListener=function(n){console.log("removeEventListener: "+n),s.forEach(function(e,t){e.listenerCallback===n&&s.splice(t,1)})},r.isConnected=function(){return void 0!==window.webkit&&void 0!==window.webkit.messageHandlers&&void 0!==window.webkit.messageHandlers.POS},r.payBasket=function(n,a){var o=[n,a];if(console.log("payBasket: "+o.join(", ")),!r.isConnected())return void a(!1,d.NotConnected);var i=new e(l.PayBasket,a,n);t(i)},r}();